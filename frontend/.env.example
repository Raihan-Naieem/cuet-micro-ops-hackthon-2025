# Frontend Environment Configuration

## Development Environment

```env
# API Configuration
VITE_API_URL=http://localhost:3000

# Sentry Configuration
# Get your DSN from https://sentry.io
VITE_SENTRY_DSN=https://your-key@sentry.io/your-project-id

# Jaeger Tracing UI (optional)
VITE_JAEGER_URL=http://localhost:16686

# Application Version
VITE_APP_VERSION=1.0.0
```

## Production Environment

```env
# API Configuration - Update to your production API endpoint
VITE_API_URL=https://api.yourdomain.com

# Sentry Configuration - Use production project
VITE_SENTRY_DSN=https://your-prod-key@sentry.io/your-prod-project-id

# Jaeger Tracing UI (optional)
VITE_JAEGER_URL=https://jaeger.yourdomain.com

# Application Version - Update with each release
VITE_APP_VERSION=1.0.0
```

## Docker Environment

When running in Docker, set these environment variables:

```bash
docker run \
  -e VITE_API_URL=http://delineate-app:3000 \
  -e VITE_SENTRY_DSN=https://your-key@sentry.io/your-project-id \
  -e VITE_JAEGER_URL=http://delineate-jaeger:16686 \
  frontend:latest
```

## Environment Variables Reference

| Variable | Required | Description | Example |
|----------|----------|-------------|---------|
| `VITE_API_URL` | Yes | Backend API endpoint | `http://localhost:3000` |
| `VITE_SENTRY_DSN` | Yes | Sentry project DSN | `https://key@sentry.io/projectid` |
| `VITE_JAEGER_URL` | No | Jaeger UI URL for tracing | `http://localhost:16686` |
| `VITE_APP_VERSION` | No | Application version | `1.0.0` |

## Setting Up Environment Files

### 1. Create `.env.local` for Development

```bash
cp .env.example .env.local
# Edit .env.local with your local settings
```

### 2. Create `.env.production` for Production

```bash
# Set production-specific environment variables
VITE_API_URL=https://api.yourdomain.com
VITE_SENTRY_DSN=https://prod-key@sentry.io/prod-project-id
```

## Vite Environment Variable Resolution

Vite resolves environment files in this order:
1. `.env` (loaded in all cases)
2. `.env.local` (loaded in all cases, ignored by git)
3. `.env.[mode]` (e.g., `.env.development`, `.env.production`)
4. `.env.[mode].local` (e.g., `.env.development.local`)

Later files override earlier ones.

## Usage in Code

Access environment variables in your TypeScript/JavaScript code using:

```typescript
import.meta.env.VITE_API_URL
import.meta.env.VITE_SENTRY_DSN
import.meta.env.MODE  // 'development' or 'production'
```

Note: Only variables prefixed with `VITE_` are exposed to client-side code.

## Sentry Setup Instructions

1. **Create a Sentry Project**
   - Go to https://sentry.io
   - Sign up or log in
   - Create a new project for React
   - Choose "React" as the platform
   - Copy the DSN

2. **Add DSN to Environment**
   ```bash
   echo "VITE_SENTRY_DSN=https://your-key@sentry.io/your-project-id" >> .env.local
   ```

3. **Test Integration**
   - Start the frontend: `npm run dev`
   - Click "Trigger Sentry Test Error" button
   - Check Sentry dashboard - error should appear within seconds

## Docker Build Arguments

When building Docker image, pass environment variables:

```dockerfile
ARG VITE_API_URL=http://localhost:3000
ARG VITE_SENTRY_DSN=https://key@sentry.io/projectid
ARG VITE_APP_VERSION=1.0.0

ENV VITE_API_URL=${VITE_API_URL}
ENV VITE_SENTRY_DSN=${VITE_SENTRY_DSN}
ENV VITE_APP_VERSION=${VITE_APP_VERSION}
```

Build with:

```bash
docker build \
  --build-arg VITE_API_URL=http://api.yourdomain.com \
  --build-arg VITE_SENTRY_DSN=https://key@sentry.io/projectid \
  -t frontend:latest .
```

## Troubleshooting

### Environment Variables Not Loading

1. Check file exists: `.env.local` or `.env.production`
2. Variables must start with `VITE_`
3. Restart dev server: `npm run dev`
4. Check vite.config.ts for proper configuration

### Sentry Not Capturing Errors

1. Verify DSN is set and valid
2. Check Sentry project is active in web UI
3. Ensure error boundary is working
4. Check browser console for initialization errors
5. Verify network requests to sentry.io in DevTools

### API Requests Failing

1. Verify `VITE_API_URL` is correct
2. Check API server is running
3. Check CORS configuration on backend
4. Verify proxy settings in vite.config.ts

## Security Notes

- Never commit `.env.local` or `.env.*.local` files to Git
- Sensitive data in client-side env variables is visible in built bundle
- Use `.env.example` to document required variables
- For secrets, use backend API instead of client-side env vars
- Rotate DSNs and API keys regularly

## CI/CD Integration

### GitHub Actions Example

```yaml
env:
  VITE_API_URL: https://api.github-actions.com
  VITE_SENTRY_DSN: ${{ secrets.SENTRY_DSN }}
  VITE_APP_VERSION: ${{ github.ref_name }}

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - uses: actions/setup-node@v2
      - run: npm ci
      - run: npm run build
```

## Additional Resources

- [Vite Environment Variables](https://vitejs.dev/guide/env-and-modes.html)
- [Sentry Documentation](https://docs.sentry.io/platforms/javascript/guides/react/)
- [OpenTelemetry Documentation](https://opentelemetry.io/docs/instrumentation/js/)
